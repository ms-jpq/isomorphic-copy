#!/usr/bin/env python3

from os import environ
from os.path import dirname, realpath
from shutil import which
from subprocess import run
from sys import stderr
from typing import Iterator


__dir__ = dirname(realpath(__file__))


def fake_path() -> None:
  paths: Iterator[str] = (path
                          for path in environ["PATH"].split(":")
                          if path != __dir__)
  environ["PATH"] = ":".join(paths)


def clippy() -> None:

  if which("pbpaste"):
    run(["pbpaste"])
  elif environ.get("TMUX"):
    run("tmux", "save-buffer", "-")
  else:
    print("⚠️ No clipboard integration ⚠️", file=stderr)
    exit(1)


def main() -> None:
  fake_path()
  clippy()


main()

